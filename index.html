<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisi Grammaticale</title>
    <style>
        :root { --primary: #630d0d; --gold: #b38b59; --bg: #f4f1ea; }
        
        body { 
            font-family: 'Palatino', 'Georgia', serif; 
            background-color: var(--bg); 
            padding: 40px 20px; 
            color: #333; 
            margin: 0;
        }

        /* Dimensioni aumentate dell'applicazione */
        .app-container { 
            max-width: 1100px; 
            margin: 0 auto; 
            background: #fff; 
            border: 1px solid #dcd0b9; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
            border-radius: 12px; 
            overflow: hidden; 
        }

        .header { 
            background: var(--primary); 
            color: white; 
            padding: 40px; 
            text-align: center; 
            border-bottom: 8px solid var(--gold); 
        }

        .header h1 { margin: 0; letter-spacing: 3px; font-size: 2.5em; text-transform: uppercase; }
        .header p { font-size: 1.2em; opacity: 0.9; margin-top: 10px; }

        .content { padding: 50px; }

        /* Timer e Progress Bar */
        .timer-box { font-size: 2em; font-weight: bold; color: #e74c3c; text-align: right; margin-bottom: 15px; }
        .bar-bg { background: #eee; height: 18px; border-radius: 9px; margin-bottom: 40px; overflow: hidden; border: 1px solid #ddd; }
        .bar-fill { background: linear-gradient(90deg, var(--gold), #d4af37); height: 100%; width: 0%; transition: 0.5s; }

        /* Testo domanda e Opzioni */
        #q-text { font-size: 1.8em; margin-bottom: 35px; line-height: 1.4; color: var(--primary); font-weight: bold; }
        
        .btn-opt { 
            display: block; 
            width: 100%; 
            padding: 22px; 
            margin: 18px 0; 
            border: 2px solid #eee; 
            background: #fdfdfd; 
            cursor: pointer; 
            text-align: left; 
            font-size: 1.4em; 
            border-radius: 10px; 
            transition: all 0.3s ease; 
        }

        .btn-opt:hover { 
            background: #fdfaf0; 
            border-color: var(--gold); 
            transform: translateX(15px); 
            box-shadow: 5px 5px 15px rgba(0,0,0,0.05);
        }

        /* Modal Risposta */
        #modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:1000; justify-content:center; align-items:center; }
        .modal { 
            background:white; 
            padding:50px; 
            max-width:800px; 
            width: 90%; 
            border-radius: 15px; 
            text-align:center; 
            border-top: 12px solid var(--primary); 
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .modal h2 { font-size: 2.2em; margin-top: 0; }
        .modal p { font-size: 1.4em; line-height: 1.6; color: #444; }

        /* Certificato e Voto */
        #certificate { display: none; border: 15px double var(--gold); padding: 60px; text-align: center; background: white; margin-bottom: 40px; }
        #certificate h1 { font-size: 3.5em; color: var(--primary); margin: 20px 0; }
        .voto-box { 
            font-size: 4em; 
            font-weight: bold; 
            color: var(--primary); 
            margin: 20px 0; 
            border: 4px solid var(--gold); 
            display: inline-block; 
            padding: 10px 40px; 
            border-radius: 15px; 
            background: #fffcf5;
        }

        .recap-item { margin-top: 15px; padding: 20px; border-left: 6px solid #e74c3c; background: #fff5f5; text-align: left; font-size: 1.1em; border-radius: 0 10px 10px 0; }

        .btn-action { 
            background: var(--primary); 
            color: white; 
            border: none; 
            padding: 20px 40px; 
            cursor: pointer; 
            border-radius: 8px; 
            font-weight: bold; 
            font-size: 1.2em; 
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-action:hover { background: #821212; }

        input[type="text"] { 
            width: 100%; 
            padding: 18px; 
            margin-bottom: 30px; 
            border: 2px solid #ddd; 
            border-radius: 8px; 
            font-size: 1.3em; 
            text-align: center;
        }
    </style>
</head>
<body>

<div class="app-container" id="main-app">
    <div class="header">
        <h1>DIPARTIMENTO DI LETTERE</h1>
        <p>Scuola Secondaria di Primo Grado</p>
        <p>Analisi Grammaticale - Attività generata parzialmente con strumenti di IA</p>
    </div>

    <div class="content" id="setup">
        <h2 style="font-size: 2em;">Benvenuto/a</h2>
        <p style="font-size: 1.3em; line-height: 1.6;">L'attività consiste in <b>50 quesiti</b> di analisi grammaticale. <br>Tempo a disposizione: <b>30 secondi</b> per ogni risposta.</p>
        <div style="max-width: 600px; margin: 40px auto;">
            <label style="display:block; margin-bottom:10px; font-weight:bold; font-size:1.1em;">Inserisci Nome:</label>
            <input type="text" id="student-name" placeholder="Esempio: Ulisse">
            <button class="btn-action" onclick="startQuiz()">INIZIA</button>
        </div>
    </div>

    <div class="content" id="quiz-ui" style="display:none;">
        <div class="timer-box">⏳ <span id="timer">30</span>s</div>
        <div class="bar-bg"><div id="bar-fill" class="bar-fill"></div></div>
        <div id="q-text"></div>
        <div id="options"></div>
    </div>

    <div class="content" id="results" style="display:none;">
        <div id="certificate">
            <p style="text-transform: uppercase; letter-spacing: 3px; font-weight: bold; color: #777;">Repubblica delle Lettere</p>
            <p style="font-size: 1.4em;">Si attesta solennemente che lo studente</p>
            <h1 id="cert-name"></h1>
            <p style="font-size: 1.4em;">ha completato la prova di Analisi Grammaticale con voto:</p>
            <div class="voto-box" id="cert-voto"></div>
            <p id="cert-giudizio" style="font-size: 1.5em; font-weight: bold; font-style: italic; margin: 20px 0;"></p>
            <p style="color: #666;">Punteggio complessivo: <span id="cert-score"></span>/50</p>
        </div>
        
        <h3 style="font-size: 1.8em; border-bottom: 2px solid var(--primary); padding-bottom: 10px;">Revisione Errori</h3>
        <div id="recap-list"></div>
        <div style="margin-top: 40px; text-align: center;">
            <button class="btn-action" onclick="window.print()">STAMPA CERTIFICATO</button>
            <button class="btn-action" style="background:#555" onclick="location.reload()">ESCI</button>
        </div>
    </div>
</div>

<div id="modal-overlay">
    <div class="modal">
        <h2 id="m-title"></h2>
        <p id="m-text"></p>
        <button class="btn-action" onclick="nextQuestion()" style="margin-top: 20px;">PROSEGUI</button>
    </div>
</div>

<script>
const db = [
    // --- NOMI E ARTICOLI (1-12) ---
    {q: "Analisi di 'lo' (es. lo zaino):", a: ["Articolo determinativo, masch. sing.", "Articolo indeterminativo", "Pronome relativo"], c: 0, e: "Si usa davanti a nomi maschili singolari che iniziano per z, s+consonante, gn, ecc."},
    {q: "Analisi di 'delle' (es. mangio delle mele):", a: ["Preposizione semplice", "Articolo partitivo, femm. plur.", "Articolo determinativo"], c: 1, e: "Indica una quantità imprecisata ('alcune')."},
    {q: "Analisi di 'sciame':", a: ["Nome collettivo, masch. sing.", "Nome individuale", "Nome astratto"], c: 0, e: "Indica un insieme di api."},
    {q: "Analisi di 'braccia' (plur. di braccio):", a: ["Nome difettivo", "Nome sovrabbondante, femm. plur.", "Nome invariabile"], c: 1, e: "I nomi sovrabbondanti hanno due plurali (braccia/bracci)."},
    {q: "Analisi di 'libertà':", a: ["Nome concreto", "Nome astratto, femm. sing.", "Nome proprio"], c: 1, e: "Indica un concetto non tangibile."},
    {q: "Analisi di 'città':", a: ["Nome invariabile", "Nome difettivo", "Nome alterato"], c: 0, e: "La forma resta identica al singolare e al plurale."},
    {q: "Analisi di 'postino':", a: ["Nome primitivo", "Nome derivato", "Nome composto"], c: 1, e: "Deriva dal nome primitivo 'posta'."},
    {q: "Analisi di 'pescecane':", a: ["Nome composto, masch. sing.", "Nome derivato", "Nome alterato"], c: 0, e: "Formato dall'unione di due nomi: pesce + cane."},
    {q: "Analisi di 'casuccia':", a: ["Nome diminutivo", "Nome vezzeggiativo (alterato)", "Nome dispregiativo"], c: 1, e: "Il suffisso -uccia indica affetto o piccolezza."},
    {q: "Analisi di 'latte':", a: ["Nome difettivo del plurale", "Nome sovrabbondante", "Nome collettivo"], c: 0, e: "È un nome che non ha il plurale."},
    {q: "Analisi di 'un' (es. un'amica):", a: ["Articolo indeterminativo, femm. sing.", "Articolo determinativo", "Aggettivo"], c: 0, e: "Si usa con apostrofo solo davanti a nomi femminili che iniziano per vocale."},
    {q: "Analisi di 'nipote':", a: ["Nome di genere comune", "Nome promiscuo", "Nome indipendente"], c: 0, e: "Il genere si capisce solo dall'articolo (il/la nipote)."},

    // --- AGGETTIVI (13-22) ---
    {q: "Analisi di 'altissimo':", a: ["Aggettivo qualificativo, grado positivo", "Superlativo assoluto", "Comparativo di maggioranza"], c: 1, e: "Indica il grado massimo senza confronti."},
    {q: "Analisi di 'migliore':", a: ["Comparativo di maggioranza", "Superlativo assoluto", "Grado positivo"], c: 0, e: "È la forma speciale per dire 'più buono'."},
    {q: "Analisi di 'questo' (es. questo libro):", a: ["Aggettivo dimostrativo", "Pronome dimostrativo", "Aggettivo possessivo"], c: 0, e: "Accompagna il nome indicando vicinanza a chi parla."},
    {q: "Analisi di 'mio' (es. il mio gatto):", a: ["Aggettivo possessivo, masch. sing.", "Pronome possessivo", "Articolo"], c: 0, e: "Indica l'appartenenza a chi parla."},
    {q: "Analisi di 'venti' (es. venti persone):", a: ["Aggettivo numerale cardinale", "Numerale ordinale", "Nome comune"], c: 0, e: "Indica un numero preciso."},
    {q: "Analisi di 'alcuni' (es. alcuni ragazzi):", a: ["Aggettivo indefinito, masch. plur.", "Aggettivo qualificativo", "Pronome"], c: 0, e: "Indica una quantità generica."},
    {q: "Analisi di 'celeberrimo':", a: ["Superlativo assoluto (forma colta)", "Comparativo", "Grado positivo"], c: 0, e: "Superlativo di 'celebre'."},
    {q: "Analisi di 'terzo':", a: ["Numerale cardinale", "Numerale ordinale", "Aggettivo qualificativo"], c: 1, e: "Indica la posizione in una serie."},
    {q: "Analisi di 'povero' (in: un pover'uomo):", a: ["Aggettivo qualificativo", "Sostantivo", "Articolo"], c: 0, e: "Attribuisce una qualità al nome uomo."},
    {q: "Analisi di 'quale' (in: quale gusto preferisci?):", a: ["Aggettivo interrogativo", "Pronome relativo", "Esclamazione"], c: 0, e: "Introduce una domanda riferita a un nome."},

    // --- PRONOMI (23-32) ---
    {q: "Analisi di 'tu':", a: ["Pronome personale soggetto", "Pronome personale compl.", "Aggettivo"], c: 0, e: "Indica la 2a persona singolare che compie l'azione."},
    {q: "Analisi di 'lo' (in: lo vedo):", a: ["Articolo determinativo", "Pronome personale compl. (atono)", "Pronome relativo"], c: 1, e: "In questo caso sostituisce 'lui' (compl. oggetto)."},
    {q: "Analisi di 'cui' (in: l'amico di cui parlo):", a: ["Pronome relativo invariabile", "Pronome interrogativo", "Congiunzione"], c: 0, e: "Serve a legare due frasi."},
    {q: "Analisi di 'ne' (in: ne ho presi due):", a: ["Particella pronominale", "Congiunzione", "Avverbio di negazione"], c: 0, e: "Significa 'di ciò', 'di essi'."},
    {q: "Analisi di 'ci' (in: ci andiamo domani):", a: ["Pronome personale", "Particella pronominale con valore avverbiale", "Articolo"], c: 1, e: "In questo caso significa 'in quel luogo'."},
    {q: "Analisi di 'qualcuno':", a: ["Pronome indefinito, masch. sing.", "Aggettivo indefinito", "Nome"], c: 0, e: "Sostituisce il nome di una persona non precisata."},
    {q: "Analisi di 'si' (in: Luca si lava):", a: ["Pronome riflessivo", "Congiunzione", "Affermazione"], c: 0, e: "L'azione del verbo si riflette sul soggetto."},
    {q: "Analisi di 'egli':", a: ["Pronome personale sogg. 3 pers. sing.", "Pronome dimostrativo", "Aggettivo"], c: 0, e: "Usato per indicare la persona di cui si parla."},
    {q: "Analisi di 'chi' (in: chi ha bussato?):", a: ["Pronome interrogativo", "Pronome relativo", "Aggettivo"], c: 0, e: "Sostituisce il nome in una domanda."},
    {q: "Analisi di 'loro' (in: ho dato loro un libro):", a: ["Pronome personale compl. (forma tonica)", "Aggettivo possessivo", "Articolo"], c: 0, e: "Funge da complemento di termine (a essi)."},

    // --- VERBI (33-42) ---
    {q: "Analisi di 'ebbi cantato':", a: ["Passato remoto", "Trapassato remoto", "Trapassato prossimo"], c: 1, e: "Tempo composto dell'indicativo che indica anteriorità al passato remoto."},
    {q: "Analisi di 'leggendo':", a: ["Gerundio presente", "Gerundio passato", "Participio"], c: 0, e: "Modo indefinito usato per indicare contemporaneità o modo."},
    {q: "Analisi di 'che essi scrivano':", a: ["Congiuntivo presente", "Indicativo presente", "Imperativo"], c: 0, e: "Modo del dubbio o del desiderio."},
    {q: "Analisi di 'sarebbe':", a: ["Condizionale presente di essere", "Futuro semplice", "Congiuntivo imperfetto"], c: 0, e: "Indica un'azione possibile a certe condizioni."},
    {q: "Analisi di 'avevano visto':", a: ["Trapassato prossimo", "Passato prossimo", "Passato remoto"], c: 0, e: "Azione avvenuta nel passato prima di un'altra azione passata."},
    {q: "Analisi di 'partito' (es. lui è partito):", a: ["Participio passato", "Participio presente", "Infinito"], c: 0, e: "Forma verbale usata per i tempi composti."},
    {q: "Analisi di 'parla!':", a: ["Imperativo presente, 2 pers. sing.", "Indicativo presente", "Gerundio"], c: 0, e: "Esprime un ordine o un'esortazione."},
    {q: "Analisi di 'potere' (in: posso andare):", a: ["Verbo servile", "Verbo ausiliare", "Verbo impersonale"], c: 0, e: "Accompagna un altro verbo all'infinito precisandone il senso."},
    {q: "Analisi di 'piovve':", a: ["Verbo impersonale, passato remoto", "Verbo riflessivo", "Verbo servile"], c: 0, e: "I verbi atmosferici non hanno un soggetto determinato."},
    {q: "Analisi di 'saremo stati premiati':", a: ["Futuro anteriore passivo", "Futuro semplice attivo", "Condizionale"], c: 0, e: "Tempo futuro anteriore espresso in forma passiva."},

    // --- PARTI INVARIABILI (43-50) ---
    {q: "Analisi di 'bene':", a: ["Avverbio di modo", "Aggettivo qualificativo", "Nome"], c: 0, e: "Specifica come avviene l'azione."},
    {q: "Analisi di 'fra':", a: ["Preposizione semplice", "Preposizione articolata", "Avverbio"], c: 0, e: "Una delle 9 preposizioni semplici (di, a, da, in, con, su, per, tra, fra)."},
    {q: "Analisi di 'non':", a: ["Avverbio di negazione", "Congiunzione", "Pronome"], c: 0, e: "Serve a negare il significato della frase."},
    {q: "Analisi di 'perché' (es. non esco perché piove):", a: ["Congiunzione subordinante causale", "Preposizione", "Pronome"], c: 0, e: "Unisce due frasi indicando il motivo (causa)."},
    {q: "Analisi di 'nello':", a: ["Preposizione articolata (in + lo)", "Articolo", "Avverbio"], c: 0, e: "Unione di preposizione semplice e articolo determinativo."},
    {q: "Analisi di 'ma':", a: ["Congiunzione avversativa", "Avverbio di tempo", "Preposizione"], c: 0, e: "Esprime un'opposizione."},
    {q: "Analisi di 'laggiù':", a: ["Avverbio di luogo", "Avverbio di tempo", "Interiezione"], c: 0, e: "Indica una posizione lontana da chi parla."},
    {q: "Analisi di 'urrà!':", a: ["Interiezione propria (Esclamazione)", "Avverbio", "Verbo"], c: 0, e: "Esprime gioia o esultanza."}
];

let current = 0; let score = 0; let name = ""; let timer; let timeLeft = 30; let mistakes = [];

// Funzione Shuffle (Fisher-Yates)
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// Funzione FullScreen e Avvio
function startQuiz() {
    name = document.getElementById('student-name').value.trim();
    if (!name) { alert("Inserisci il tuo nome per validare l'esame."); return; }
    
    // Attivazione Schermo Intero
    let elem = document.documentElement;
    if (elem.requestFullscreen) { elem.requestFullscreen(); }
    else if (elem.webkitRequestFullscreen) { elem.webkitRequestFullscreen(); }
    else if (elem.msRequestFullscreen) { elem.msRequestFullscreen(); }

    document.getElementById('setup').style.display = 'none';
    document.getElementById('quiz-ui').style.display = 'block';
    loadQ();
}

function loadQ() {
    clearInterval(timer);
    timeLeft = 30;
    document.getElementById('timer').innerText = timeLeft;
    
    const q = db[current];
    document.getElementById('q-text').innerText = `${current + 1}. ${q.q}`;
    document.getElementById('bar-fill').style.width = `${(current / db.length) * 100}%`;
    
    const opts = document.getElementById('options'); 
    opts.innerHTML = '';
    
    // Mescoliamo una copia delle risposte
    const shuffledAnswers = shuffleArray([...q.a]);
    
    shuffledAnswers.forEach((t) => {
        const b = document.createElement('button'); 
        b.className = 'btn-opt'; 
        b.innerText = t;
        // Troviamo l'indice originale del testo scelto per il controllo
        b.onclick = () => check(q.a.indexOf(t)); 
        opts.appendChild(b);
    });
    
    timer = setInterval(countDown, 1000);
}

function countDown() {
    timeLeft--;
    document.getElementById('timer').innerText = timeLeft;
    if(timeLeft <= 0) { clearInterval(timer); check(-1); }
}

function check(idx) {
    clearInterval(timer);
    const q = db[current];
    const isCorrect = idx === q.c;
    
    if(isCorrect) {
        score++;
        document.getElementById('m-title').innerHTML = "<span style='color:green'>CORRETTO ✅</span>";
    } else {
        mistakes.push({q: q.q, c: q.a[q.c]});
        document.getElementById('m-title').innerHTML = "<span style='color:red'>SBAGLIATO ❌</span>";
    }

    document.getElementById('m-text').innerText = q.e;
    document.getElementById('modal-overlay').style.display = 'flex';
}

function nextQuestion() {
    document.getElementById('modal-overlay').style.display = 'none';
    current++;
    if(current < db.length) {
        loadQ();
    } else {
        showEnd();
    }
}

function showEnd() {
    document.getElementById('quiz-ui').style.display = 'none';
    document.getElementById('results').style.display = 'block';
    document.getElementById('certificate').style.display = 'block';
    document.getElementById('cert-name').innerText = name;
    
    // Calcolo Voto in Decimi
    const voto = (score / db.length) * 10;
    document.getElementById('cert-voto').innerText = voto.toFixed(1) + " / 10";
    document.getElementById('cert-score').innerText = score;
    
    let giudizio = "";
    if(voto >= 9) giudizio = "Eccellente: Conoscenza della lingua magistrale.";
    else if(voto >= 7.5) giudizio = "Ottimo: Competenze grammaticali molto solide.";
    else if(voto >= 6) giudizio = "Sufficiente: Conoscenza basilare, si consiglia ripasso.";
    else giudizio = "Gravemente Insufficiente: Necessario recupero didattico.";
    document.getElementById('cert-giudizio').innerText = giudizio;

    const list = document.getElementById('recap-list');
    list.innerHTML = ""; 
    mistakes.forEach(m => {
        list.innerHTML += `<div class="recap-item"><strong>${m.q}</strong><br>La risposta corretta era: <em>${m.c}</em></div>`;
    });
}
</script>

</body>
</html>



